# Афинный шифр: Взлом с использованием перебора ключей

Афинный шифр — это один из простейших и наиболее известных методов симметричного шифрования, который использует линейную функцию для преобразования символов текста. Он основан на математической формуле, связывающей каждый символ открытого текста с символом зашифрованного текста через два параметра: `a` и `b`.

## Описание проекта

Данный проект реализует метод криптоанализа афинного шифра для русского алфавита. Код перебирает все возможные комбинации ключей, дешифрует текст и выбирает подходящие строки на основе заданных критериев.

## Пример использования

```python
ciphertext = "бцияхъпаххъпкцмлчлпежмьктлжцднрльклзнэияхиглякцяльгксняжмкгицияпкхмрлглжшлцктажбглыкйнслйихажмциягайль"
```

При запуске программы получаем вот твкой текст
```bash
$ main.py
Ключи (a=7, b=8): яваслмбиллмбовъещебытъюожетвдушеюоейугасланесовсеюнопустъонавасболъшенетревожитянехочупечалитъвасничею
Ключи (a=25, b=13): фсувизтлиизтесчоьотшбчхенобспаыохеокарувиужовесвохжедавбчежусувтеичыожобгосенлбфжоюеъадоъуилбчсувжлъох
```

## Принципы работы афинного шифра

### Шифрование

Афинный шифр шифрует символы согласно следующей формуле:

$$
E(x) = (a \cdot x + b) \mod m
$$

где:
- $E(x)$ — зашифрованный символ,
- $x$ — индекс символа в алфавите,
- $a$ и $b$ — параметры шифрования,
- $m$ — размер алфавита (количество символов).

**Пример**:
Для русского алфавита, содержащего 33 буквы (`а` = 0, `б` = 1, ..., `я` = 32), если мы выберем $a = 5$ и $b = 3$, то символ `а` (индекс 0) будет зашифрован следующим образом:

$$
E(0) = (5 \cdot 0 + 3) \mod 33 = 3 \quad \text{(символ `г`)}
$$

Таким образом, буква `а` будет зашифрована как `г`.

### Расшифровка

Для расшифровки используется обратная формула:

$$
D(y) = a^{-1} \cdot (y - b) \mod m
$$

где $D(y)$ — это расшифрованный символ, а $a^{-1}$ — обратное значение $a$ по модулю $m$. 

Чтобы найти $a^{-1}$, необходимо, чтобы $a$ и $m$ были взаимно простыми (т.е. их наибольший общий делитель равен 1). 

**Пример**:
Если зашифрованный символ имеет индекс `г` (3), то его расшифровка будет выглядеть так:

1. Найдем $a^{-1}$. Для $a = 5$ и $m = 33$ это будет $a^{-1} = 20$ (так как $5 \cdot 20 \mod 33 = 1$).
2. Расшифровка символа `г` (индекс 3):

$$
D(3) = 20 \cdot (3 - 3) \mod 33 = 0 \quad \text{(символ `а`)}
$$

### Недостатки афинного шифра

1. **Небольшое пространство ключей**:
   - Параметр `a` должен быть взаимно прост с $m$ (размером алфавита), что ограничивает количество возможных значений для `a`. Например, для русского алфавита из 33 букв подходящих значений для `a` не так много.
   - Параметр `b` может принимать значения от 0 до $m-1$, что также ограничивает пространство ключей. В результате общее количество возможных ключей невелико.

2. **Уязвимость к криптоанализу**:
   - Из-за небольшого пространства ключей афинный шифр поддается атаке методом перебора. Криптоаналитики могут легко перебрать все возможные комбинации ключей и расшифровать текст.
   - Анализ частоты символов также может быть использован для нахождения параметров `a` и `b`, так как шифр сохраняет структуру частотности. Например, наиболее часто встречающиеся буквы в открытом тексте будут соответствовать наиболее часто встречающимся буквам в зашифрованном тексте.